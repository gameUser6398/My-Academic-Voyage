分区 文献阅读 的第 75 页

高质量 ARG（高）：如果 UNI 基因在其整个长度上与 CARD/ARDB-ARG 具有 90% 的同一性≥则
该基因被标记为“高”注释因子。这种相似性临界值已被用于其他研究，用于识别相关的
ARG[40,41]，并且比构建ARDB数据库时使用的临界值更严格[28]。
同源 ARG （Mid）：≥如果 UNI 基因具有 50% 和 ≤90% 的同一性，并且 CARD / ARDB-ARG 的
e 值低于 1e-10，并且对 CARD/ARDB-ARG 的注释一致，则用“Mid”注释因子标记。
潜在的 ARG（手动检查）：如果 UNI 基因具有 50% 的同一性且 CARD/ARDB-ARG 的 e 值低于
1e-10<，并且对 CARD/ARDB-ARG 的注释一致，则该基因被标记为“手动检查”。该基因被认为
是一种潜在的ARG，但证据不足，因此需要进一步分析其抗生素耐药性的真实性。
丢弃的 ARG（低）：如果 UNI 基因的注释与最佳命中的 CARD/ARDB-ARG 不同且 e 值大于
1e-10，则该基因将被丢弃。请注意，该基因可能仍是 ARG，但由于缺乏足够的证据，它被从当
前的考虑中删除以确保 ARG 注释质量。
图3

验证 UNIPROT 注释。将UNIPROT基因与CARD和ARDB数据库进行比对。为每个 UNI 基因（最佳命
中）选择具有最高比特分数的比对，并应用一组过滤器来确定 UNI 基因注释因子
（AnnFactor）

总共有16,222个基因被标记为“高”和“中”注释因子。在去除单核苷酸多态性（SNP）注释为
赋予抗性的序列后，总共剩下10,602个UNIPROT，2203个CARD和2128个ARDB基因用于下游分
析。DeepARG-DB 总共包含 14,933 个基因，包括三个数据库（CARD、ARDB 和 UNIPROT）。该数
据库用于构建深度学习模型。

全尺寸图像

深度学习

监督式机器学习模型通常分为表征单元、训练单元和预测单元。表征单元负责将 DNA 序列表示
为称为特征的数值。它需要一组基于全局或局部序列属性的 DNA 描述符。在这里，使用了基于
差异的分类概念[42]，其中序列通过它们与已知ARG的同一距离来表示和特征。选择CARD和ARDB
基因来代表已知的ARG，而UNIPROT（High+Mid）基因用于模型的训练和验证。DeepARG由两个模
型组成：DeepARG-LS和DeepARG-SS，前者用于根据全基因长度序列对ARG进行分类，后者用于从
短序列读长中识别和分类ARGs（见图1）。4）.比特分数被用作相似性指标，因为它考虑了序列
之间的同一性程度，并且与e值不同，它与数据库大小无关[29]。计算不同性表示的过程如下。
使用DIAMOND [18]将UNIPROT基因与CARD和ARDB数据库[27,28]进行比对，但有非常宽松的约束：
最大命中数为10,000次，代表UNIPROT基因比对的报告命中总数，最小同一性为20%（-id 20），
e值小于1e-10。 然后将位分数归一化为 [0， 1] 区间，以将序列相似性表示为距离。因此，接
近 0 的分数表示距离小或相似度高，而接近 1 的分数表示距离较远。因此，构建了一个特征矩

分区 文献阅读 的第 76 页

近 0 的分数表示距离小或相似度高，而接近 1 的分数表示距离较远。因此，构建了一个特征矩
阵，其中行对应于 UNIPROT 基因与特征（ARDB/CARD 基因）的序列相似性。
图4

分类框架。UNIPROT基因用于验证和训练，而CARD和ARDB数据库被用作特征。从 UNIPROT 到
ARGs 数据库的基因之间的距离是使用序列比对位分数计算的。使用具有允许截止的 DIAMOND 进
行比对，允许对每个 UNIPROT 基因进行大量命中。此分布用于训练和验证深度学习模型（图中
的面板提供了有关模型训练的附加说明）

随后创建了一个深度学习模型 DeepARG，用于将宏基因组序列注释为抗生素耐药性类别。与其他
机器学习技术相比，深度学习的主要优势之一是它能够在不需要人工干预的情况下区分相关特征
[43,44,45]。它因其解决多类分类问题的能力而受到强调[34,46,47,48,49]。在这里，通过考虑
序列到所有已知 ARG 的身份距离分布来训练深度学习多类模型。这种分布代表了通过完全连接
的网络传播的高级序列抽象。DeepARG 模型由 2000、1000、500 和 100 个单位的四个密集隐藏
层组成，这些隐藏层将比特分数分布传播到密集和抽象的特征。输入层由 4333 个单元组成，对
应于 ARDB 和 CARD 的 ARG。这些功能在训练和评估期间使用。为了避免过度拟合，使用
dropout技术以不同的速率从模型中移除随机隐藏单元[50]。最后，深度神经网络的输出层由30
个单元组成，这些单元对应于抗生素耐药性类别（参见附加文件1：表S1）。输出层使用
softMax [51， 52] 激活函数，该函数针对每个 ARG 类别计算输入序列的概率。概率用于定义
输入序列所属的 ARG 类别。DeepARG 架构是使用 Python Lasagne [53] 模块实现的，该模块是
广泛使用的 Theano [54] 深度学习库的高级包装器。由于深度学习需要密集的计算资源，因此
训练是使用 Theano 的 GPU 例程进行的。然而，为了获得深度学习模型，只需要进行一次繁重
的计算，预测程序不需要这样的计算资源。
通常使用两种策略从宏基因组数据中识别 ARG;一种使用短读长直接预测 ARG，而另一种使用来
自组装重叠群的预测开放阅读框（即全基因长度序列）来预测 ARG。为了实现这两种注释策略，
我们开发了两种深度学习模型，即 DeepARG-SS 和 DeepARG-LS，分别用于处理短读长和全基因
长度序列。DeepARG-SS模型专门设计用于对Illumina等NGS技术生成的短读长进行分类。因此，
ARG被分成小序列以模拟短序列读取（见图1）。4b）。DeepARG-LS使用完整的ARG序列进行训
练，可用于注释新的ARG基因（见图1）。4a），例如，在MetaHit联盟的组装重叠群中检测到的
开放阅读框[55]。请注意，每个模型都经过单独训练和验证，以确保高性能。

来自 <https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-018-0401-z>
