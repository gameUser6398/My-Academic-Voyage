结果与讨论
为了评估 DeepARG 模型（DeepARG-SS 和 DeepARG-LS）的性能，我们进行了五种不同的实验，

分区 文献阅读 的第 77 页

为了评估 DeepARG 模型（DeepARG-SS 和 DeepARG-LS）的性能，我们进行了五种不同的实验，
并与最佳命中方法进行了比较。预测质量通过精确度、召回率和 F1 分数指标进行评估，定义
为：

����我�我��=����+��,

���一个��=����+��,

�1 �����=2∗����我�我��∗���一个������我�我��+���一个��,
其中 TP 表示真阳性（即，来自感兴趣类别的 ARG 被正确预测为该 ARG 类别）、FP 假阳性
（来自不同类别的 ARG 被预测为来自感兴趣类别）和 FN 假阴性（来自感兴趣类别的 ARG 被预
测为不同的 ARG 类别）。
请注意，由于 DeepARG 管道的第一步包括使用 DIAMOND 进行序列比对，因此非 ARG（短读长或
全长基因）会被过滤掉，并且不考虑用于进一步预测。因此，比对阶段仅将 e 值< 1e-10 且同
一性> 20% 的类似 ARG 的序列传递给 DeepARG 进行预测。因此，性能反映了 DeepARG 模型区
分 30 种抗生素耐药性类别的能力（参见附加文件 1：表 S1）。

抗生素耐药性数据库

在合并数据库并去除重复项后，分别从ARDB（占完整ARDB的50%）、CARD数据库（占所有CARD基
因的49%）和UNIPROT（占UNIPROT总ARG样序列总数的70%）数据库中共收集了2161个、2290个和
28,108个基因。对于 UNIPROT 基因，使用可用的基因描述共注释了 16,360 个基因。在通过序
列相似性进行验证并去除因 SNP 而产生抗性的基因后，剩下 10,602 个 UNIPROT、2203 CARD
和 2128 个 ARDB ARG 序列。由此产生的数据库 DeepARG-DB 包括 30 个抗生素类别、2149 个
组和 14,933 个参考序列 （CARD+ARDB+UNIPROT）。超过34%的基因属于β-内酰胺酶类别
（5136），其次是杆菌肽类（4205），大环内酯类-林可酰胺-链球菌素（MLS）类
（1109）7.4%，氨基糖苷类（915），5.8%属于多混合素类（879），5.8%属于多药类（877，见
图）。5a）。UNIPROT 数据库贡献最大的类别对应于 β-内酰胺、杆菌肽、MLS 和多粘菌素。然
而，在UNIPROT数据库中并未找到所有ARG类别，例如艾达霉素、夫西地酸和嘌呤霉素等（见图
1）。详见5b）。DeepARG-DB 的局限性之一是它依赖于 CARD 和 ARDB 数据库的质量。因此，为
了避免来自CARD和ARDB的错误传播，手动检查和纠正了基因类别和组，特别是ARDB和CARD数据库
之间不同的注释。由于 UNIPROT 和 CARD 是不断更新的，因此 DeepARG-DB 也将作为经过训练
的深度学习模型进行相应的更新和版本控制。
图5

分区 文献阅读 的第 78 页

a DeepARG-DB中30种抗生素类别的序列数分布。b ARG类别在ARDB数据库、CARD数据库和UNIPROT
数据库中的相对贡献

全尺寸图像

短序列读取预测

为了模拟典型的宏基因组文库，将 UNIPROT 基因拆分为 100 个核苷酸长序列，总共生成了
321,008 个读段。随后对 DeepARG-SS 模型进行了训练和测试，其中 70% 的读取被随机选择用
于训练，而其余 30% 则保留用于验证。在测试的 30 种抗生素类别中，总体精密度为 0.97，召
回率为 0.91（见图 1）。6a）。相比之下，最佳命中方法的总体精度为0.96，召回率为0.51。
实现最佳命中方法的高精度并不奇怪，因为该方法依赖于高身份约束，并且据报道可以预测少量
的假阳性，但大量的假阴性[19]。我们观察到，这两种方法在大多数类别中都产生了高精度（见
图1）。6b）。然而，这两种方法在三氯生类别中表现不佳，可能是因为该类别仅由数据库中的
四个基因表示。
图6

分区 文献阅读 的第 79 页

使用精度、召回率和 F1 分数作为训练和测试数据集的指标，对 DeepARG 模型与最佳命中方法
进行性能比较。MEGARes 条形图对应于使用 MEGARes 数据库中的基因的 DeepARG-LS 的性
能。b DeepARG模型的精确度和召回率，与测试数据集中每个单独类别的最佳命中方法相比。
*UNIPROT基因用于测试，并非所有ARG类别都具有来自UNIPROT数据库的基因

全尺寸图像

DeepARG-SS 模型对于人口丰富的抗生素耐药类别（如 β 内酰胺酶、杆菌肽和 MLS）表现特别
好，但对于以少量 ARG 为代表的类别（如三氯生和氨基香豆素）则表现不佳。由于神经网络模
型的性质，这一结果是意料之中的。随着可用于训练模型的数据越多，它们的最终性能就越好。
相比之下，最佳命中方法对某些包含有限数量的 ARG 的 ARG 类别产生了完美的预测，但对于具
有大量 ARG 的类别则没有（见图 1）。6b 和附加文件 2：表 S2 了解详情）。
对于多药抗生素耐药性类别，DeepARG-SS模型的召回率几乎完美（0.99），这意味着只有少数多
药读数被归类为其他类别。然而，与其他类别相比，DeepARG-SS模型的假阳性率也最高（精度为
0.27），这意味着许多非多药读数被注释为多药序列。另一方面，最佳命中方法显示出更高的精
度（0.44），但召回率要低得多（0.44）。多药类包含对多种抗生素类药物产生耐药性的基因，
如大环内酯类、β-内酰胺酶、糖肽类、喹诺酮类药物以及金属等其他抗菌药物[56,57]。 这些
基因通常具有相似的序列，这使得计算方法难以确定短读长的真实身份。因此，当读取产生的最

分区 文献阅读 的第 80 页

基因通常具有相似的序列，这使得计算方法难以确定短读长的真实身份。因此，当读取产生的最
佳预测概率小于 0.9 时，DeepARG 会报告手动检查的前两个 ARG 类别。两种方法的低精度表
明，其他非多药类别可能包含与多药类别具有高度序列相似性的基因。这说明现有数据库仍有很
大的改进空间。
与多药类别相反，“未知”抗生素耐药性类别的准确度很高，为0.87，但召回率低，为0.42，表
明假阴性率高。因此，来自未知抗生素耐药性类别的读数可能会被错误地分配/预测为其他抗生
素耐药性类别。这凸显了检查未知类别是否实际上包含来自其他 ARG 类别的基因的必要性，例
如 β-内酰胺类、大环内酯类、三氯生等。相比之下，对于“未知”抗生素类别，最佳命中方法
的性能最差（见图1）。6b 和附加文件 2：表 S2）。总的来说，与几乎所有 ARG 类别的最佳命
中方法相比，DeepARG-SS 模型的误阴性率都有显著改善。

预测长 ARG 样序列

DeepARG-LS模型使用全基因长度序列进行训练和测试。将UNIPROT验证的基因拆分为训练集（70%
的数据）和验证集（30%的数据），并使用CARD和ARDB数据库作为特征。DeepARG-LS模型显示出
类似的结果，预测不同类别的ARG的总体精度为0.99，召回率为0.99。 DeepARG-LS的性能比
DeepARG-SS更好，因为较长的序列比较短的读取包含更多的信息（图1）。特别是，DeepARG-LS
对数据库中具有高度代表性的抗生素类别（如杆菌肽、β-内酰胺酶、氯霉素和氨基糖苷类）实
现了高精度（0.97±0.03）和几乎完美的召回率（0.99±0.01）。6b 和附加文件 3：表 S3 了
解详情）。相比之下，最佳命中方法达到了完美的精度（1.00 ± 0.00），但这些类别的召回率
要低得多（0.48 ± 0.2）。与DeepARG-SS类似，DeepARG-LS在基因较少的类别（如磺胺类和莫
匹罗星）中表现不佳（详见附加文件3：表S3）。

来自 <https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-018-0401-z>

已知和经验证的 ARG 的性能预测

为了进一步评估和验证性能，将DeepARG-LS模型应用于MEGARes数据库中的所有ARG序列[58]。该
数据库包含来自 CARD [27]、ARG-ANNOT [59] 和 RESFINDER [60] 的手动整理的 ARG。在该测
试中，通过SNP产生的机制赋予抗性的ARG被去除。将 DeepARG-LS 预测与数据库注释进行比较，
得出的总体精度和召回率分别为 0.94 和 0.93（图 0.93）。6 和附加文件 4：表 S4）。对于
具有大量基因的类别，例如 β 内酰胺酶、艾法霉素、磷霉素、糖肽、MLS 和磺胺类，DeepARG-
LS 模型实现了 0.99 ± 0.05 的近乎完美的精度和 0.96 ± 0.03 的召回率。然而，该模型在
具有少量基因的类别中表现不佳（参见附加文件4：表S4）。例如，MEGARes 有一个
Tunicamycin 基因，该基因被 DeepARG-LS 模型指定为喹诺酮类，概率为 0.6。如此低的概率
0.6 表明该基因具有多个注释。当手动检查该基因的完整注释时，发现 DeepARG-LS 模型以 0.3
的概率预测了正确的标记（衣霉素），表明对于该特定类别，需要更多的基因序列来训练模
型。DeepARG-DB数据库只有三个衣霉素基因，这也许可以解释为什么这个基因没有被正确分类。
然而，值得注意的是，尽管硫链虫的训练基因数量较少，但其预测是正确的。多药类别是最难预
测的类别之一，包含约200个基因。对于多药类别，DeepARG-LS模型的精确度为0.7，召回率为
0.6。这一结果表明，需要手动检查标记为多药的基因以及分配给多药类别的其他类别的基因。
注释属于多药类别的基因的挑战进一步凸显了审查、比较和寻求不同抗生素耐药性数据库之间共
识的更广泛需求。

通过新型 ARG 进行验证

为了测试DeepARG-LS模型预测新型ARGs的能力，Berglund等[61]的一项独立研究获得了一组76个
金属β内酰胺酶基因。这些新基因已通过功能宏基因组学方法进行实验验证，以赋予大肠杆菌对
碳青霉烯类的耐药性。在这项研究中，通过筛选数千个宏基因组和细菌基因组来筛选一组精选的
β内酰胺酶，进行了大规模分析。使用在一组 β 内酰胺酶上训练和优化的隐马尔可夫模型，收

分区 文献阅读 的第 81 页

β内酰胺酶，进行了大规模分析。使用在一组 β 内酰胺酶上训练和优化的隐马尔可夫模型，收
集了 76 个 β 内酰胺酶候选新基因。进行了实验验证，21 个测试基因中有 18 个能够水解亚
胺培南。因此，这 76 个 β 内酰胺酶基因预计大部分是真正的 ARG，并为进一步测试和验证
DeepARG-LS 模型提供了独特的机会。有趣的是，在 76 个新的 ARG 中，DeepARG-LS 模型能够
预测 65 个（假设所有 76 个都是真正的 ARG 的准确率为 85%）作为 β 内酰胺酶的正确抗生
素类别，概率大于 0.99。其余9个基因也被DeepARG-LS模型正确预测，但由于它们的比对覆盖率
低（即<50%;比对长度/ARG长度）而被过滤掉。需要注意的重要一点是，DeepARG-LS模型是在30
种抗生素类别中训练的，并且没有针对检测任何一种特定的抗生素类别进行优化。因此，这一结
果有力地证明了DeepARG-LS模型检测新型ARG的能力。当然，DeepARG 预测高精度的一种可能性
是，这 76 个基因和/或其密切相关的基因被包含在 DeepARG-LS 模型的训练中。为了验证这种
可能性，使用DIAMOND[18]将76个β内酰胺酶基因与DeepARG-DB中的所有序列进行了比较，并提
取了每个基因的最佳命中值。图 7b 显示，令人惊讶的是，在 DeepARG-DB 中鉴定出的所有最佳
命中与 76 种 β 内酰胺酶的序列相似度都低于 40%，这表明 DeepARG 预测的高准确性不是由
于在训练 DeepARG-LS 模型时包含了这些基因和/或其密切相关的基因。事实上，图。图7b显示
了训练中使用的β内酰胺酶基因的成对同一分布。大多数β-内酰胺酶基因彼此非常相似，成对
同一性大于90%，只有少数基因具有较低的成对同一性值。综上所述，这些分析表明，使用一组
不同的β内酰胺酶基因进行训练，即DeepARG-LS模型，能够学习远亲基因的特异性，从而检测它
们。因此，DeepARG-LS模型在鉴定新型ARG方面显示出前景。相比之下，使用具有50%（或更高）
通用身份截止值的最佳命中方法[62]的常见做法将无法检测到所有这些新的ARG。 请注意，
DeepARG施加的长度要求可以根据具体的研究问题进行放宽和调整。例如，如果识别尽可能多的
潜在新型 ARG 是主要关注点，则可以使用比 DeepARG 默认值更宽松的长度约束。
图7

a 76 个新型 β 内酰胺酶基因对 DeepARG 数据库 （DeepARG-DB） 的同一性分布。每个点对应
于每个新基因的最佳命中率，其中颜色表示 E 值 （<1e-10），大小表示比对覆盖率 （>
40%）。b DeepARG 数据库中 β 内酰胺酶基因的成对身份分布

全尺寸图像

通过计算机模拟加标实验进行验证

对于来自真实世界样本的宏基因组数据集，ARG读长可能只占总读长的一小部分。因此，研究
DeepARG-SS 模型在非靶基因占主导地位的情况下的表现非常重要。为了测量 DeepARG-SS 模型
在绝大多数非 ARG 读数中区分/识别少量 ARG 读数的能力，构建了一个模拟尖峰宏基因组实验
的负宏基因组数据集。首先，从几个真核生物基因组（智人、Muss 肌肉
和 Acanthisitta cholirs）中提取一组 6,485,966 个 100 bps 的读段，以生成大多数非 ARG
读段（因为真核生物基因组预计具有很少的 ARG 样序列）。其次，通过从PATRIC数据库中筛选
已知的ARGs来筛选细菌基因组，建立了一组阳性的ARG读数[63]。仅使用整个基因中同一性在
70% 到 90% 之间且 e 值低于 1e-10 的区域，并从这些区域随机提取 10,000 个 100 bps 的短
读长以形成一小部分 ARG 读长。
图 8 显示了 DeepARG-SS 对 10,000 个非显性 ARG 读数的预测结果。预计只有一个非 ARG 读
段是具有 78% 身份的 ARG 读段，而其余的非 ARG 读段在序列比对步骤中被丢弃，原因是未能
满足 DeepARG 强加的 4333 个特征 ARG 中至少一个的至少 20% 序列身份的要求。因此，尽管

分区 文献阅读 的第 82 页

满足 DeepARG 强加的 4333 个特征 ARG 中至少一个的至少 20% 序列身份的要求。因此，尽管
数据集包含大量非 ARG 读数，但 DeepARG-SS 模型能够以高灵敏度识别和预测少量的 ARG 读
数。例如，使用默认预测概率临界值 0.8，真阳性数（预测到正确抗生素类别的 ARG 读数）为
9976，而假阴性数（预测到错误抗生素类别的 ARG 读数）为 24，灵敏度为 0.99
（9976/10000）。这些结果表明，首先，DeepARG中的比对步骤可以作为滤波器，可以有效去除
非ARG序列，其次，尽管信号较弱，但DeepARG-SS可以正确预测ARG读数，并且具有很高的灵敏
度。请注意，尽管 ARG 样区域对已知 ARG 具有 70-90% 的序列同一性，但由于 ARG 的整个序
列具有不同程度的序列守恒性和多样性，提取的读长对 ARG 具有 50-100% 的更宽的序列同一性
（图 1）。8）.
图8

使用 DeepARG-SS 模型对加标数据集的 ARG 进行分类的预测结果。未显示非ARG读段（真核读
段）的结果，因为DeepARG-SS能够在使用DIAMOND的比对步骤中去除它们

全尺寸图像

在实践中，短读的注释通常使用最佳命中方法执行。对于这种策略，已知ARG的同一性截止值在
80%-90%之间被广泛接受，因为它具有较低的假阳性率[62]。当使用 80% 截止值时，最佳命中方
法产生了 4486 个假阴性和 5514 个真阳性，因此灵敏度 （0.55） 远低于 DeepARG。正如预期
的那样，这些临界值的最佳命中方法可能导致宏基因组数据集中ARG含量的低估甚至错误推断。
相比之下，DeepARG-SS 模型旨在识别尽可能多的真阳性，同时最大限度地减少假阴性的数量。
为了实现这一点，DeepARG-SS 模型检查了所有命中的分布，而不是仅仅依赖于最佳命中。因
此，DeepARG-SS模型能够识别正确的抗生素类别，更重要的是，通过为每个预测提供分类概率，
最大限度地减少错误分类错误。我们的实证分析表明，当使用 DeepARG 进行预测时，这种可能
性是需要考虑的重要指标。例如，大多数具有低预测概率（< 0.5）的分类都是错误的，并且对
应于不同ARG类别中常见的读数，而对于高概率（> 0.8）的分类，只有两个错误的预测被观察
到。因此，在执行分类时，建议将概率截止值设置为 0.8。此外，DeepARG 概率与序列同一性无
关，这意味着即使序列同一性较低，获得正确分类的可能性仍然很高。
尽管如此，需要澄清的是，尽管该评估的假阴性和假阳性率较低，但 DeepARG 模型的性能取决
于训练数据库的质量。如图所示。8、有四种不正确的分类，>0.75的概率。这些错误可能是由数
据库中的错误标签生成的。因此，ARG的持续管理和/或验证对于提高ARGs预测的准确性至关重
要。
还观察到一些预测概率< 0.5 的错误分类。这些读数的低概率表明它们被预测为多种抗生素类

分区 文献阅读 的第 83 页

还观察到一些预测概率< 0.5 的错误分类。这些读数的低概率表明它们被预测为多种抗生素类
别。因此，概率在不同的抗生素类别之间共享。为了避免此类错误，DeepARG  使用 0.8 的最小
概率截止值（默认值），用户可以修改该截止值。DeepARG  还可以调整对齐阶段使用的身份截
止。这些参数允许用户根据自己的需要产生或多或少严格的分类。

通过 PseudoARG 进行验证

为了进一步检查 DeepARG 区分可能包含 ARG 片段但不是真正 ARG（即 pseudoARG）的基因的能
力，创建了一组 pseudoARG。这些基因是通过从不同的ARG类别中随机挑选k-mer来构建的，如下
所示：为了构建一个基因，从一个特定的ARG类别中随机选择50个氨基酸长的5个k-mer。然后，
从另外十个ARG类别中随机选择两个50-mer。最后，重复这个过程以构建 300 个具有部分 ARG
含量的基因。这个假阳性数据集模拟了来自不同类别的基因在其序列中具有相似性的情况，例
如，相同的结构域或基序。然后使用 DeepARG-LS 模型和最佳命中方法对 pseudoARG 数据集进
行分类。正如预期的那样，最佳命中方法无法过滤掉误报 ARG，并产生了 57% 的高误报率，身
份截止为 50%（图 50）。9），而使用较低的临界值会进一步增加误报的数量。相比之下，使用
默认的分类概率截止值 0.8，DeepARG-LS 模型能够过滤掉 300 个伪 ARG 中的 285 个（5% 假
阳性率）。这表明 DeepARG-LS 模型在区分伪 ARG 方面优于最佳命中方法，进一步支持了
DeepARG 模型通过考虑目标序列与所有 ARG 类别的相似性来学习 ARG 类别的唯一性。
图9

DeepARG分类概率和最佳命中标识的分布。每个点都表示每个“部分”负 ARG 与 DeepARG 数据
库的对齐。水平线表示 DeepARG 预测的默认设置，即概率高于 0.8 的预测被 DeepARG 视为高
质量分类

全尺寸图像

DeepARG的局限性和使用建议

DeepARG-LS 和 DeepARG-SS 这两个 DeepARG 模型针对不同的 ARG 预测策略进行了定制。例
如，研究人员现在通常收集不同的环境样本，对DNA进行测序以获得宏基因组数据，并使用这些
数据来解决“样本中存在哪些类型的ARG？在这种情况下，通过宏基因组数据，可以通过将
DeepARG-SS 模型直接应用于读数来简单地预测读数属于哪些 ARG 类别，类似于计算机加标宏基
因组实验。这项任务可以快速完成，因为实验表明，在配备 i7 处理器和 16Gb 内存的个人
MacBook Pro 上预测 1 亿次短读只需要 50 分钟。如前所述，训练 DeepARG 模型非常耗时，但
只需完成一次。或者，可以首先将短读数组装成重叠群，使用重叠群的 ORF 识别/预测程序获得
开放阅读框 （ORF），然后在 ORF 上运行 DeepARG-LS 模型来预测 ARG 类别。相比之下，后一
种策略可能要慢得多，因为它涉及序列组装，但预测可能比直接预测读取更准确。这是意料之中

分区 文献阅读 的第 84 页

种策略可能要慢得多，因为它涉及序列组装，但预测可能比直接预测读取更准确。这是意料之中
的，因为序列越长，包含的信息就越多，因此对 ARG 预测的信心就越大。从结果中也可以清楚
地看出，DeepARG-LS模型的表现优于DeepARG-SS模型（图1）。6）. 在容易获得完整基因长度序
列的情况下，例如76个新的β内酰胺酶基因，可以部署DeepARG-LS来预测相应的ARG类别。
有几点值得讨论。首先，DeepARG模型在30个ARG类别中进行了训练，旨在预测基因或短读长属于
这些类别中的哪一类。它不打算也不能用于预测由SNP引起的抗生素耐药性。其次，DeepARG 模
型只能预测基因或读数是否属于模型考虑的 30 个类别之一。如果基因或读数属于全新的 ARG
类别，DeepARG 将无法预测它。在这种情况下，值得注意的是，30 个类别的预测概率预计很
低，人们应该谨慎对待预测，如果需要一组高质量的 ARG 预测，可能会放弃预测。第三，
DeepARG模型的性能取决于训练数据库的质量;即，训练数据的质量越高，模型的预测精度就越
高。对预测结果的详细分析表明，一些ARG类别可能存在注释错误，尤其是多药和“未知”类
别，这反过来又对模型的预测产生不利影响。这凸显了研究界在策划和改进ARG命名法和注释数
据库方面持续和协同努力的重要性。第四，与所有计算机预测一样，DeepARG模型可用于概述或
推断序列集合中抗生素耐药性的种类;严格来说，需要进行下游实验验证，以确认序列是否真正
具有抗性。

来自 <https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-018-0401-z>